## üõ°Ô∏è Policy Evaluation

| **Environments** | **Success** | **Omitted** | **Failed** | **Failed (Blocking)** | **Failed (Warning)** | **Failed (Recommend)** |
|--------------|---------|---------|--------|---------|---------|---------|
{{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}}| `{{ $env }}` | `{{ $sum.PolicyCounts.TotalSuccess }}`‚úÖ | `{{ $sum.PolicyCounts.TotalOmitted }}`‚è≠Ô∏è | `{{ $sum.PolicyCounts.TotalFailed }}`‚ùå | `{{ $sum.PolicyCounts.BlockingFailedCount }}`üö´ | `{{ $sum.PolicyCounts.WarningFailedCount }}`‚ö†Ô∏è | `{{ $sum.PolicyCounts.RecommendFailedCount }}`üí° |
{{ end }}

<details> <summary> Policy Evaluation Matrix: </summary>

| Policy Name | stg | prod |
|-------------|-----|------|
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.BlockingPolicies}}| {{$policy.PolicyName}} | {{if $policy.IsPassing}}‚úÖ PASS{{else}}‚ùå FAIL{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.BlockingPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if $prodPolicy.IsPassing}}‚úÖ PASS{{else}}‚ùå FAIL{{end}}{{end}}{{end}} |
{{- end}}
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.WarningPolicies}}| {{$policy.PolicyName}} | {{if $policy.IsPassing}}‚úÖ PASS{{else}}‚ùå FAIL{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.WarningPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if $prodPolicy.IsPassing}}‚úÖ PASS{{else}}‚ùå FAIL{{end}}{{end}}{{end}} |
{{- end}}
{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.RecommendPolicies}}| {{$policy.PolicyName}} | {{if $policy.IsPassing}}‚úÖ PASS{{else}}‚ùå FAIL{{end}} | {{range $prodPolicy := $.PolicyEvaluation.PolicyMatrix.prod.RecommendPolicies}}{{if eq $prodPolicy.PolicyId $policy.PolicyId}}{{if $prodPolicy.IsPassing}}‚úÖ PASS{{else}}‚ùå FAIL{{end}}{{end}}{{end}} |
{{- end}}

</details>

<details> <summary> Details of failing policies: </summary>

### üö´ BLOCKING Policies |{{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.BlockingFailedCount}}`‚ùå |{{end}}

These policies are blocking your PR merge. Resolve them or override them if applicable. Please note that overriding policies mean you are aware of the risks and consequences of your actions.

#### [`stg`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.BlockingFailedCount 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.BlockingPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}

{{else}}
* None! üôå
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.BlockingFailedCount 0 }}
#### [`prod`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.BlockingPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}
{{else}}
* None! üôå
{{end}}

### ‚ö†Ô∏è WARNING Policies | {{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.WarningFailedCount}}`‚ùå |{{end}}

These policies failure does not block your PR merge, but only faling the CI status. Please consider fixing them. Please note that overriding policies mean you are aware of the risks and consequences of your actions.

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.WarningFailedCount 0 }}
#### [`stg`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.WarningPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}
{{else}}
* None! üôå
{{end}}

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.WarningFailedCount 0 }}
#### [`prod`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.WarningPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}
{{else}}
* None! üôå
{{end}}

### üí° RECOMMEND Policies | {{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.RecommendFailedCount}}`‚ùå |{{end}}

These policies are recommendations. They are not required to be resolved, but you may consider fixing them if applicable for your case.

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.RecommendFailedCount 0 }}
#### [`stg`] environment 

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.RecommendPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}
{{else}}
* None! üôå
{{end}}

#### [`prod`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.RecommendFailedCount 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.RecommendPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}
{{else}}
* None! üôå
{{end}}

### ‚è≠Ô∏è Omitted Policies | {{range $env, $sum := .PolicyEvaluation.EnvironmentSummary}} `{{$env}}`: `{{$sum.PolicyCounts.TotalOmittedFailed}}`‚ùå |{{end}}

These policies are omitted. They are evaluated but the results are not considered. Usually these are policies that you have overriden, or policies that has yet to be in effect yet (not date yet).

#### [`stg`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.stg.PolicyCounts.TotalOmittedFailed 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.OverriddenPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}

{{range $policy := .PolicyEvaluation.PolicyMatrix.stg.NotInEffectPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}

{{else}}
* None! üôå
{{end}}

#### [`prod`] environment 

{{- if gt .PolicyEvaluation.EnvironmentSummary.prod.PolicyCounts.TotalOmittedFailed 0 }}

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.OverriddenPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}

{{range $policy := .PolicyEvaluation.PolicyMatrix.prod.NotInEffectPolicies}}
* Policy `{{$policy.PolicyName}}` failed with the following messages:
{{range $msg := $policy.FailMessages}}  * {{$msg}}
{{end}}
{{end}}

{{else}}
* None! üôå
{{end}}

</details>
